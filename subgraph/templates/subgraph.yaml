specVersion: 0.0.2
description: Sublimate
schema:
    file: ./schema.graphql
dataSources:
    - kind: ethereum/contract
      name: GreetingsRegistry
      network: {{chainName}}
      source:
          address: '{{contracts.GreetingsRegistry.address}}'
          abi: GreetingsRegistryContract
          startBlock: {{contracts.GreetingsRegistry.receipt.blockNumber}}
      mapping:
          kind: ethereum/events
          apiVersion: 0.0.3
          language: wasm/assemblyscript
          entities:
              - MessageEntry
          abis:
              - name: GreetingsRegistryContract
                file: ./abis/GreetingsRegistry.json
          eventHandlers:
              - event: MessageChanged(indexed address,string)
                handler: handleMessageChanged
          file: ./mappings/greetings.ts
    - kind: ethereum/contract
      name: StreamableERC20
      network: {{chainName}}
      source:
          address: '{{contracts.StreamableERC20.address}}'
          abi: StreamableERC20Contract
          startBlock: {{contracts.StreamableERC20.receipt.blockNumber}}
      mapping:
          kind: ethereum/events
          apiVersion: 0.0.3
          language: wasm/assemblyscript
          entities:
              - User
              - Subscription
          abis:
              - name: StreamableERC20Contract
                file: ./abis/StreamableERC20.json
          eventHandlers:
              - event: SubscriptionStarted(indexed address,indexed address,uint256,uint256)
                handler: handleSubscriptionStarted
              - event: SubscriptionStopped(indexed address,indexed address)
                handler: handleSubscriptionStopped
              - event: SubscriptionCanceled(indexed address,indexed address)
                handler: handleSubscriptionCanceled
          file: ./mappings/streamable-subscriptions.ts
